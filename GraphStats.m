%E.E.E.-analyzer - GRAPH ENGINE by Fabio Pinciroli
%Copyright 2016 Fabio Pinciroli DISTRIBUTED UNDER GPL V3 LICENSE
%TODO: NONE

function GraphStats(dati, name, fDir, figSaveMode)
    %define edges (now every 1 degrees)
    edges = 0:1:360;
    
    %do bins
    dist = histcounts (dati(:,15), edges);
    
    %apply correction factor
    correction = [0.42210469 0.416945276 0.411912965 0.407000338 0.402199963 0.397504403 0.392906235 0.38839806 0.383972518 0.379622296 0.375340149 0.371118904 0.366951478 0.36283089 0.358774014 0.354823223 0.350891382 0.346970719 0.343053653 0.339132807 0.335201018 0.331251352 0.327277116 0.323271867 0.319229427 0.315158647 0.311041394 0.306845331 0.302573988 0.298262861 0.293905522 0.289617209 0.28527699 0.281099941 0.276907973 0.272815093 0.268856049 0.264873584 0.261130264 0.257457108 0.253773547 0.250358345 0.247038311 0.243719979 0.240525259 0.237604085 0.23469523 0.231799646 0.229043492 0.226567595 0.224113877 0.221683573 0.219278022 0.217095919 0.215116222 0.213167958 0.211252546 0.209371481 0.207526327 0.205878556 0.204442557 0.203046254 0.201691119 0.200378668 0.199110466 0.197888119 0.196713276 0.19559238 0.194778752 0.194012607 0.193295339 0.192628369 0.192013134 0.191451093 0.190943719 0.190492499 0.190098935 0.189764537 0.189490824 0.18927932 0.189131554 0.189049054 0.189033349 0.189085966 0.189208423 0.189402233 0.189668897 0.190043711 0.190494905 0.191010253 0.191590815 0.191010253 0.190494905 0.190043711 0.189668897 0.189402233 0.189208423 0.189085966 0.189033349 0.189049054 0.189131554 0.18927932 0.189490824 0.189764537 0.190098935 0.190492499 0.190943719 0.191451093 0.192013134 0.192628369 0.193295339 0.194012607 0.194778752 0.19559238 0.196713276 0.197888119 0.199110466 0.200378668 0.201691119 0.203046254 0.204442557 0.205878556 0.207526327 0.209371481 0.211252546 0.213167958 0.215116222 0.217095919 0.219278022 0.221683573 0.224113877 0.226567595 0.229043492 0.231799646 0.23469523 0.237604085 0.240525259 0.243719979 0.247038311 0.250358345 0.253773547 0.257457108 0.261130264 0.264873584 0.268856049 0.272815093 0.276907973 0.281099941 0.28527699 0.289617209 0.293905522 0.298262861 0.302573988 0.306845331 0.311041394 0.315158647 0.319229427 0.323271867 0.327277116 0.331251352 0.335201018 0.339132807 0.343053653 0.346970719 0.350891382 0.354823223 0.358774014 0.36283089 0.366951478 0.371118904 0.375340149 0.379622296 0.383972518 0.38839806 0.392906235 0.397504403 0.402199963 0.407000338 0.411912965 0.416945276 0.42210469 0.416945276 0.411912965 0.407000338 0.402199963 0.397504403 0.392906235 0.38839806 0.383972518 0.379622296 0.375340149 0.371118904 0.366951478 0.36283089 0.358774014 0.354823223 0.350891382 0.346970719 0.343053653 0.339132807 0.335201018 0.331251352 0.327277116 0.323271867 0.319229427 0.315158647 0.311041394 0.306845331 0.302573988 0.298262861 0.293905522 0.289617209 0.28527699 0.281099941 0.276907973 0.272815093 0.268856049 0.264873584 0.261130264 0.257457108 0.253773547 0.250358345 0.247038311 0.243719979 0.240525259 0.237604085 0.23469523 0.231799646 0.229043492 0.226567595 0.224113877 0.221683573 0.219278022 0.217095919 0.215116222 0.213167958 0.211252546 0.209371481 0.207526327 0.205878556 0.204442557 0.203046254 0.201691119 0.200378668 0.199110466 0.197888119 0.196713276 0.19559238 0.194778752 0.194012607 0.193295339 0.192628369 0.192013134 0.191451093 0.190943719 0.190492499 0.190098935 0.189764537 0.189490824 0.18927932 0.189131554 0.189049054 0.189033349 0.189085966 0.189208423 0.189402233 0.189668897 0.190043711 0.190494905 0.191010253 0.191590815 0.191010253 0.190494905 0.190043711 0.189668897 0.189402233 0.189208423 0.189085966 0.189033349 0.189049054 0.189131554 0.18927932 0.189490824 0.189764537 0.190098935 0.190492499 0.190943719 0.191451093 0.192013134 0.192628369 0.193295339 0.194012607 0.194778752 0.19559238 0.196713276 0.197888119 0.199110466 0.200378668 0.201691119 0.203046254 0.204442557 0.205878556 0.207526327 0.209371481 0.211252546 0.213167958 0.215116222 0.217095919 0.219278022 0.221683573 0.224113877 0.226567595 0.229043492 0.231799646 0.23469523 0.237604085 0.240525259 0.243719979 0.247038311 0.250358345 0.253773547 0.257457108 0.261130264 0.264873584 0.268856049 0.272815093 0.276907973 0.281099941 0.28527699 0.289617209 0.293905522 0.298262861 0.302573988 0.306845331 0.311041394 0.315158647 0.319229427 0.323271867 0.327277116 0.331251352 0.335201018 0.339132807 0.343053653 0.346970719 0.350891382 0.354823223 0.358774014 0.36283089 0.366951478 0.371118904 0.375340149 0.379622296 0.383972518 0.38839806 0.392906235 0.397504403 0.402199963 0.407000338 0.411912965 0.416945276];
    dist = dist.*correction;
    
    %{
    [edgeNum, ~] = size(dist);
    for cnt = 1:1:edgeNum
        dist(cnt) = dist(cnt) * correction(cnt);
    end
    %}
    
    
    %polar plot 
    figure('Name', strcat(name, ' - polar'));
    polarplot(dist);
    title(strcat(name, ' - POLAR'));
    ax = gca;
    ax.ThetaZeroLocation = 'top';
    ax.ThetaDir = 'clockwise';
    saveas(gcf, [fDir, strcat('POLAR - ', name)], figSaveMode);
    close();
    
    %standard plot
    figure('Name', name);
    plot(dist);
    title(name);
    grid on;
    xlim([0 360]);
    saveas(gcf, [fDir, name], figSaveMode);
    close();
end